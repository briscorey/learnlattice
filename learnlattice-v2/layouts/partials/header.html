{{ $dropdowns := newScratch }}
{{ range .Site.Params.nav_dropdowns }}
  {{ $dropdowns.Set .key .items }}
{{ end }}

<nav>
  <a class="nav-brand" href="/">
    {{ partial "logo.html" . }}
    <span class="nav-title">Learn<span class="nav-title-accent">Lattice</span></span>
  </a>

  <button class="nav-toggle" type="button" aria-expanded="false" aria-controls="site-menu" aria-label="Toggle navigation">
    <span></span>
    <span></span>
    <span></span>
  </button>

  <div class="nav-panel" id="site-menu">
  <ul class="nav-links">
    {{ range .Site.Menus.main }}
    {{ $items := $dropdowns.Get .Identifier }}
    <li class="nav-item{{ if $items }} has-dropdown{{ end }}">
      <a href="{{ .URL }}" class="nav-link{{ if or ($.IsMenuCurrent "main" .) (eq $.RelPermalink .URL) }} active{{ end }}">
        {{ .Name }}
        {{ if $items }}
        <svg class="nav-caret" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.4"><polyline points="6 9 12 15 18 9"/></svg>
        {{ end }}
      </a>
      {{ if $items }}
      <div class="nav-dropdown">
        {{ range $items }}
        <a class="nav-dropdown-item" href="{{ .url }}">
          <span class="nav-dropdown-title">{{ .title }}</span>
          {{ with .description }}<span class="nav-dropdown-copy">{{ . }}</span>{{ end }}
        </a>
        {{ end }}
      </div>
      {{ end }}
    </li>
    {{ end }}
  </ul>

  <div class="nav-search" id="search-trigger">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
    <span>Search resources...</span>
    <kbd>âŒ˜K</kbd>
  </div>
  </div>
</nav>
