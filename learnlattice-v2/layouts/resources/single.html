{{ define "main" }}

<article class="resource-single">
  <div class="resource-single-header">
    <a href="/resources/" class="resource-single-back">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
      Back to Resources
    </a>

    <h1>{{ .Title }}</h1>

    <div class="resource-single-tags">
      {{ range .Params.subjects }}
        <span class="resource-tag">{{ . }}</span>
      {{ end }}
      {{ range .Params.year_levels }}
        <span class="resource-tag">{{ . }}</span>
      {{ end }}
      {{ range .Params.resource_types }}
        <span class="resource-tag">{{ . }}</span>
      {{ end }}
      {{ range .Params.tags }}
        <span class="resource-tag">{{ . }}</span>
      {{ end }}
    </div>

    <div class="resource-single-date">
      Published {{ .Date.Format "January 2, 2006" }}
    </div>
  </div>

  <!-- At a Glance -->
  <div class="at-a-glance">
    <h3 class="at-a-glance-heading">At a Glance</h3>
    <dl class="at-a-glance-grid">
      {{ with index .Params.subjects 0 }}
      <div class="at-a-glance-item">
        <dt><span aria-hidden="true">ðŸ“–</span> Subject</dt>
        <dd>{{ . }}</dd>
      </div>
      {{ end }}
      {{ with index .Params.year_levels 0 }}
      <div class="at-a-glance-item">
        <dt><span aria-hidden="true">ðŸŽ“</span> Year Level</dt>
        <dd>{{ . }}</dd>
      </div>
      {{ end }}
      {{ with index .Params.resource_types 0 }}
      <div class="at-a-glance-item">
        <dt><span aria-hidden="true">ðŸ“‹</span> Type</dt>
        <dd>{{ . }}</dd>
      </div>
      {{ end }}
      {{ with .Params.formula }}
      <div class="at-a-glance-item">
        <dt><span aria-hidden="true">ðŸ§®</span> Key Formula / Concept</dt>
        <dd>{{ . }}</dd>
      </div>
      {{ end }}
    </dl>
    {{ if .Params.tags }}
    <div class="at-a-glance-tags">
      {{ range .Params.tags }}
        <a class="at-a-glance-tag" href="/tags/{{ . | urlize }}/">{{ . }}</a>
      {{ end }}
    </div>
    {{ end }}
  </div>

  {{ with .Params.download_url }}
  <div class="download-box">
    <div class="download-box-info">
      <h4>ðŸ“„ Download Resource</h4>
      <p>{{ $.Params.download_label | default "PDF document" }}</p>
    </div>
    <a href="{{ . }}" class="btn-primary" download>
      Download
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
    </a>
  </div>
  {{ end }}

  <div class="resource-content">
    {{ .Content }}
  </div>

  {{ with .Params.download_url }}
  <div class="download-box" style="margin-top: 48px;">
    <div class="download-box-info">
      <h4>ðŸ“„ Download Resource</h4>
      <p>{{ $.Params.download_label | default "PDF document" }}</p>
    </div>
    <a href="{{ . }}" class="btn-primary" download>
      Download
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
    </a>
  </div>
  {{ end }}
</article>

{{ partial "topic-pathways.html" (dict
  "page" .
  "mode" "compact"
  "headline" "Where This Resource Branches"
  "copy" "This resource sits inside larger topic pathways. Use these branch links to extend the lesson into adjacent concepts and inquiry routes."
) }}

<!-- Related Resources -->
{{ $related := .Site.RegularPages.Related . | first 3 }}
{{ if $related }}
<section class="section">
  <div class="section-header">
    <h2 class="section-title">Related Resources</h2>
  </div>
  <div class="resources-grid">
    {{ range $related }}
      {{ partial "resource-card.html" . }}
    {{ end }}
  </div>
</section>
{{ end }}

{{ end }}
