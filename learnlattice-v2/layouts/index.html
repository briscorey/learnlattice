{{ define "main" }}
{{ $home := .Site.Params.home }}
{{ $resources := where .Site.RegularPages "Section" "resources" }}
{{ $mathLinks := slice
  (dict "title" "All MYP Mathematics" "url" "/subjects/mathematics/" "copy" "Browse the full MYP mathematics collection.")
  (dict "title" "Algebra" "url" "/tags/algebra/" "copy" "Patterns, equations, and linear relationships.")
  (dict "title" "Criterion D" "url" "/tags/criterion-d/" "copy" "Real-world mathematical application tasks.")
}}
{{ $scienceLinks := slice
  (dict "title" "All MYP Science" "url" "/subjects/science/" "copy" "Browse the full MYP science collection.")
  (dict "title" "Biology" "url" "/subjects/biology/" "copy" "Cells, systems, and living processes.")
  (dict "title" "Ecology" "url" "/subjects/ecology/" "copy" "Ecosystems, biodiversity, and fieldwork.")
  (dict "title" "Space Science" "url" "/subjects/space-science/" "copy" "Astronomy, models, and planetary systems.")
  (dict "title" "Earth Science" "url" "/subjects/earth-science/" "copy" "Tectonics, earthquakes, and Earth systems.")
  (dict "title" "Chemistry" "url" "/subjects/chemistry/" "copy" "Particles, mixtures, and reactions.")
}}
{{ $gradeLinks := slice
  (dict "title" "BC Grade 6" "url" "/year-levels/bc-grade-6/")
  (dict "title" "BC Grade 7" "url" "/year-levels/bc-grade-7/")
  (dict "title" "BC Grade 8" "url" "/year-levels/bc-grade-8/")
  (dict "title" "BC Grade 9" "url" "/year-levels/bc-grade-9/")
}}
{{ $browseLinks := slice
  (dict "title" "All Resources" "url" "/resources/" "copy" "Open the full resource library.")
  (dict "title" "Unit Plans" "url" "/resource-types/unit-plan/" "copy" "Longer inquiry sequences and full units.")
  (dict "title" "Worksheets" "url" "/resource-types/worksheet/" "copy" "Structured practice and reflection.")
  (dict "title" "Lab Activities" "url" "/resource-types/lab-activity/" "copy" "Practical investigations and experiments.")
  (dict "title" "Investigation Packs" "url" "/resource-types/investigation-pack/" "copy" "Guided inquiry packs and evidence tasks.")
  (dict "title" "Topic Pathways" "url" "/#topic-pathways" "copy" "Browse by concept instead of by subject.")
}}

<section class="home-minimal-hero">
  <div class="page-header page-header-compact">
    <div class="hero-eyebrow">{{ $home.hero_eyebrow }}</div>
    <h1>{{ $home.hero_title }}</h1>
    <p>{{ .Site.Params.description }}</p>
    <div class="hero-actions">
      <a href="{{ $home.hero_primary_url }}" class="btn-primary">{{ $home.hero_primary_label }}</a>
      <a href="{{ $home.hero_secondary_url }}" class="btn-secondary">{{ $home.hero_secondary_label }}</a>
    </div>
  </div>
</section>

<div class="stats reveal">
  <div class="stat">
    <span class="stat-num">{{ len $resources }}+</span>
    <span class="stat-label">Downloadable<br>resources</span>
  </div>
  <div class="stat-divider"></div>
  <div class="stat">
    <span class="stat-num">6</span>
    <span class="stat-label">MYP subject<br>branches</span>
  </div>
  <div class="stat-divider"></div>
  <div class="stat">
    <span class="stat-num">4</span>
    <span class="stat-label">BC grade<br>collections</span>
  </div>
</div>

<section class="section reveal">
  <div class="section-header">
    <div>
      <h2 class="section-title">{{ $home.myp_math_title }}</h2>
      <p class="section-subtitle">{{ $home.myp_math_subtitle }}</p>
    </div>
  </div>
  <div class="simple-link-grid simple-link-grid-compact">
    {{ range $mathLinks }}
      <a class="simple-link-card" href="{{ .url }}">
        <h3>{{ .title }}</h3>
        <p>{{ .copy }}</p>
      </a>
    {{ end }}
  </div>
</section>

<section class="section reveal">
  <div class="section-header">
    <div>
      <h2 class="section-title">{{ $home.myp_science_title }}</h2>
      <p class="section-subtitle">{{ $home.myp_science_subtitle }}</p>
    </div>
  </div>
  <div class="simple-link-grid">
    {{ range $scienceLinks }}
      <a class="simple-link-card" href="{{ .url }}">
        <h3>{{ .title }}</h3>
        <p>{{ .copy }}</p>
      </a>
    {{ end }}
  </div>
</section>

<section class="section reveal">
  <div class="section-header">
    <div>
      <h2 class="section-title">{{ $home.grades_title }}</h2>
      <p class="section-subtitle">{{ $home.grades_subtitle }}</p>
    </div>
  </div>
  <div class="simple-link-grid simple-link-grid-compact">
    {{ range $gradeLinks }}
      {{ $count := len (where $resources "Params.year_levels" "intersect" (slice .title)) }}
      <a class="simple-link-card" href="{{ .url }}">
        <h3>{{ .title }}</h3>
        <p>{{ $count }} resources</p>
      </a>
    {{ end }}
  </div>
</section>

<section class="section reveal">
  <div class="section-header">
    <div>
      <h2 class="section-title">{{ $home.browse_title }}</h2>
      <p class="section-subtitle">{{ $home.browse_subtitle }}</p>
    </div>
  </div>
  <div class="simple-link-grid">
    {{ range $browseLinks }}
      <a class="simple-link-card" href="{{ .url }}">
        <h3>{{ .title }}</h3>
        <p>{{ .copy }}</p>
      </a>
    {{ end }}
  </div>
</section>

{{ if $resources }}
<section class="section reveal">
  <div class="section-header">
    <h2 class="section-title">{{ $home.latest_title }}</h2>
    <a href="{{ $home.latest_link_url }}" class="section-link">
      {{ $home.latest_link_label }}
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
    </a>
  </div>
  <div class="resources-grid">
    {{ range first 6 $resources }}
      {{ partial "resource-card.html" . }}
    {{ end }}
  </div>
</section>
{{ end }}

{{ if .Site.Taxonomies.tags }}
<section class="section reveal" id="popular-topics">
  <div class="section-header">
    <h2 class="section-title">{{ $home.topics_title }}</h2>
  </div>
  <div class="topics-wrap">
    {{ range .Site.Taxonomies.tags.ByCount }}
      <a class="topic-pill" href="{{ .Page.RelPermalink }}">
        {{ .Page.Title }} <span class="count">{{ .Count }}</span>
      </a>
    {{ end }}
  </div>
</section>
{{ end }}

<div id="topic-pathways">
{{ partial "topic-pathways.html" (dict
  "page" .
  "showAll" true
  "headline" $home.pathways_title
  "copy" $home.pathways_copy
) }}
</div>

<div class="featured-banner reveal">
  <div class="featured-inner">
    <div class="featured-text">
      <h2>{{ $home.featured_title }}</h2>
      <p>{{ $home.featured_copy }}</p>
    </div>
    <a href="{{ $home.featured_link_url }}" class="btn-amber">{{ $home.featured_link_label }}</a>
  </div>
</div>

{{ end }}
